


#define PUNCH_CS 0177554
#define PUNCH_DB 0177556

char invaderOne [] = {0x70, 0x18, 0x7d, 0xb6, 0xbc, 0x8c, 0xbc, 0xb6, 0x7d, 0x18, 0x70, 0x00};
char invaderTwo [] = {0x1e, 0xb8, 0x7d, 0x36, 0x3c, 0x3c, 0x3c, 0x36, 0x7d, 0xb8, 0x1e, 0x00};
char invaderThree [] = {0x98, 0x5c, 0xb6, 0x5f, 0x5f, 0xb6, 0x5c, 0x98, 0};
char invaderFour [] = {0x58, 0xbc, 0x16, 0x3f, 0x3f, 0x16, 0xbc, 0x58, 0};
char invaderFive [] = {0x9c, 0x9e, 0x5e, 0x76, 0x37, 0x5f, 0x5f, 0x37, 0x76, 0x5e, 0x9e, 0x9c, 0};
char invaderSix [] = {0x1c, 0x5e, 0xfe, 0xb6, 0x37, 0x5f, 0x5f, 0x37, 0xb6, 0xfe, 0x5e, 0x1c, 0};
char skull [] = { 0x1c, 0xe2, 0x89, 0xe9, 0x81, 0xe9, 0x89, 0xe2, 0x1c, 0};

char * icons [] = {invaderOne, invaderTwo, invaderThree, invaderFour, invaderFive, invaderSix, skull, skull};

int  putPunchChar (int ch)
{
  while (*((volatile char *) (PUNCH_CS))>=0); // Wait for punch ready
  *((volatile int *) (PUNCH_DB)) = ch;
  return 0;
}


void punchInvader(char * invader) {
  char ch;
  int i;
  while ((ch = invader[i++])!=0) {
    putPunchChar(ch);
  }
}

#define SWR 0177570

int readSWR () {
  return *( (volatile int *) (SWR));
}



int main () {
  int icon_index;
  while(1) {
    icon_index = (0x3 & readSWR()) << 1;
    punchInvader(icons[icon_index]);
    putPunchChar(0);
    putPunchChar(0);
    punchInvader(icons[icon_index+1]);
    putPunchChar(0);
    putPunchChar(0);
  }
}
